# The C Programming Language

C语言, 历史悠长, 自从它于80年代伴随 Unix 出现, 便成为了全世界开发者的心头好.
至今为止都依然被广泛使用.
上到各种琳琅满目的应用程序, 下到操作系统内核, 都可以由C编写, 都依赖C的代码.

举个例子: 世界上的绝大多数服务器, 都是由 `Linux` 承载着的, 而 `Linux` 的内核,
几乎只有 `C` 所编写的代码.
当然, 在大家的手机上, 任何一部安卓手机
(除了苹果手机, 都可以被认为是安卓手机, 不过没差,
苹果 `iOS` 的内核 `Drawin` 比 `Android` 里面的C代码要纯粹得多)
它的内核, 其实也是Linux, 可以说, C驱动着世界上绝大多数设备的运行.
(之所以不用Windows举例, 一是Windows是一个闭源产品, 二是Windows内核主要由微软自己魔改的C++代码编写)

C是一门高级语言, 但是何为高级语言?

## 高级语言

高级语言是相对于低级语言而言的.
一般而言, 我们所说的低级语言, 是各个不同设备上面的汇编语言, 这些语言非常强大, 可以操作 CPU,
也非常基础, 一旦没有它们, 任何后续的工作都无法进行.
但是它们的问题也非常严重. 那就是它们与平台极度绑定, 一段代码, 只能在特定平台上工作.
即便逻辑相似, 或者完全一致, 但是你还是不得不按照不同平台的规定, 为它们依次适配.
这仅仅只是开发过程, 就已经可以体会到通过低级语言开发程序的麻烦了.
而到了软件升级这一步骤, 这样的一套流程就更加恐怖, 复杂度直线上升.

而高级语言, 是一种对于低级语言共同特征的抽象,
帮助程序员写出可以在不同平台间无痛或相对轻松移植的代码.

当通过C编程语言进行工作的时候, 我们可以抽象出加减乘除等操作, 分别对应操作不同位数数据的汇编指令;
可以抽象出各种变量, 直接对应内存中的一段空间.

比如:
对于C而言, 无论哪个平台的加法都可以通过 `a + b` 来完成,
但是对于 `IBM` 兼容机型的 `x86_64` 架构 `intel` 语法宏汇编 (好长的定语) 而言,
则可能是 `ADD AH, BH`, `ADD AX, BX`, `ADD EAX, EBX`, 乃至于 `ADD RAX, RBX`
这里甚至只是考虑到只有两个通用寄存器参与运算的情况, 如果还有内存, 还要复杂的多.
(其实如果用 `AT&T` 语法还能更复杂些, 毕竟 `AT&T` 还要考虑指令名的问题).

这就为程序的移植提供了极大的方便, 不再需要手动为不同的平台进行适配.

## 中级语言

C语言虽然名义上是一个高级语言, 但是很多人并不这么认为, 因为C语言并不提供一种通用的内存管理方案.
所有的内存都需要由程序员自己来手动管理. 这为系统编程提供了便利, 但也造成了不少内存泄漏等问题.
依旧需要考虑与低级语言汇编相似的边界问题.

因此, 便有人将C语言称作中级语言, 过渡语言. 不过, 这不过是称呼上的差别而已.

## 编译 & 解释

CPU 实际上只能够理解和运行二进制的机器码.
因此, 直接以人类可读形式写出来的代码, 计算机没有办法直接执行.
这就需要对代码进行编译, 或者解释.

编译, 是将代码编译到汇编语言 (或其他语言), 再通过汇编器生成对应二进制代码,
最后链接
(链接是操作系统相关的, 如果不需要操作系统, 仅为裸机 (bare metal / bare machine)
则可能不需要链接 (若将代码分到多个文件则需要静态链接), 也无法动态链接)
产生原生可执行程序
(该可执行程序会最终包含操作系统需要的结构, 如Windows的PE, 或者*nix的ELF, Drawin 的 Mach-O)
的一种过程.

解释, 则是不经过编译过程, 通过虚拟机, 或者解释器, 随读入源文件执行代码的过程.

实际上, 对于现代语言, 编译型语言和解释型语言的区别并没有特别大,
比如, java语言就既需要编译到`JVM bytecode`, 也需要用 `JVM` 解释字节码运行.

而我们, 会在一门语言更倾向于如何运行, 来说这个语言是编译型语言, 或解释型语言.
比如, C语言, 就是一门会要求编译, 再运行的语言, 因此, 我们认为, C语言, 是一门编译型语言.
再如, 大家或许熟悉的Python语言, 便是通过解释器执行的, 因此才认为python语言是一门编译型语言.

## 环境

不知道大家是否喜欢玩 PC 上的游戏,
有时候玩游戏会提示缺少 `DirectX` 运行时环境,
编程也和玩游戏一样, 是需要环境的. 一般而言, 我们将这种专门用于开发程序的环境, 称作开发环境.
而将所有开发所需要的工具和开发环境本身, 一起打包, 并预先配置的软件系统,
就称作集成式开发环境(IDE).

在 Windows 平台上, 最常用的C语言 IDE 是 Microsoft (C) Visual Studio,
不过这个 IDE 以及它配套的编程环境, 都是为了 C++ 和 C# 而量身设计的, 并不太适用于 C 语言,
而它强制要求的工程管理, 以及提供的过多功能, 也容易导致初学者眼花缭乱, 忽视C语言学习的核心.

而 MacOS 平台上, 苹果公司提供了 Xcode IDE, 不过除了不得不写 Swift, 也几乎没有人使用它.

Linux 平台, 最常用的 "IDE" 是 (Neo)Vim 和 Emacs, 不过, 并不适合所有人使用.

鉴于平台相对不易统一, 而以上三个平台,
均提供了相对简单的方式以 `LLVM-Clang` 编译器作为 C语言 的编程环境,
在此处, 我们将采用手动配置环境的方式, 来作为学习C语言的第一步.
这也是大多数教程, 机构, 学校, 并不会教授, 而对于后续编程学习至关重要的一个部分.

另两个个人认为相对重要的部分是工具的使用和工具与知识的区别,
分别可以在 "计算机教育中缺失的一课 (The Missing Semester of Your Computer Science Education)"
和 "理论计算机导论 (Introduction to Theoretical Computer Science)"
中找到.

### 环境变量

环境变量是一种可以被程序读取, 并根据其值进行配置的一些 "键-值" 对.
简单的理解, 就是杂志的目录, 当我试图索引一些信息的时候,
可以先去目录找到 "键", 然后根据 "键" 取得 "值".

而这些组合, 可以控制程序的行动.
目前需要了解, 并且对于今后都非常重要的一些环境变量分别是:

1. `PATH`: Path 环境变量, 故名思意, 便是一些路径, 那么, 究竟是什么东西的路径呢?
实际上, Path 是执行指令时的搜索路径. 当我们在控制台(命令行) 输入一些指令,
并试图执行它们的时候, 操作系统就会通过 Path 环境变量搜索,
如果可以找到, 就执行对应找到的指令, 如果没有, 则会报错.
当然, 不只是我们自己执行指令的时候需要用到Path, 很多其他的程序也会通过 PATH 来找到它需要的程序.
比如动态链接器 (`ld-linux-x86_64.so`)

2. 好吧其实目前只用知道 PATH 一个就够了 (

### Windows

对于 Windows 而言, 环境变量的修改非常便捷安全:

打开 文件资源管理器 (Explorer), 右键点选 "此电脑",
并在弹出菜单中选择 "属性" - "高级系统设置" - "高级" - "环境变量" 即可看见环境变量的配置窗口.

如果需要编辑任何之一, 只需要双击点选项目, 就可以看见对应修改界面了.

### Linux, MacOS & *nix

对于类Unix及Unix系统而言, 环境变量的修改往往和用户配置文件相关联.
不过, 实际上, 要在这类系统上安装 C 的编程环境, 完全不需要对环境变量做过多修改,
而可以简单通过几行命令完成.

以下是一些参考:

+ MacOS:

``` sh
xcode-select --install
```

+ Linux (Debian & Ubuntu *):

``` sh
sudo apt install base-devel
```

+ Linux (Arch *):

``` sh
sudo pacman -Syy gcc make
```

+ Linux (RHEL & Fedora *):

``` sh
sudo dnf group install "Development Tools"
```

+ FreeBSD:

``` sh
pkg install gcc
```

## Hello, World

于是便到了我们的第一个程序: Hello, World!

这是一个来自于 C程序设计语言 (the C Programming Language) 中的例子, 同时,
它也陪伴了一代又一代新生的程序员. 带着我们对自己创造的新世界的欢呼.

``` C
#include <stdio.h>

int main(void) {
  printf("Hello, World!");
  return 0;
}
```

这段程序, 首先是一串以 '#' 号开头的文本, 这句话表示, 我们引入了一个名叫stdio的库的定义.

Stdio, 是 "Standard Input / Output" 的简称, 它定义了常用的输入和输出函数,
它也将会成为C语言程序设计中最常用的库.

'#' 号, 实际上代表了 "预处理指令" 的开始, 这里的预处理指令就是 "include".
Include指令常常被用来包含一个文件, 这里, 就包含了 stdio.h 这个文件.

那么include指令是怎么样确定它需要包含哪些文件的呢? 实际上这取决于他需要包含的文件通过什么包裹.
比如在这里, 我们就使用尖括号 ('<' 和 '>') 包裹了 stdio.h, 它表示编译器会从系统路径中查找,
如果找到这个文件, 就将这个文件完整展开在指令处.
而如果我们通过双引号 ('"') 包裹了 stdio.h, 编译器就会先尝试从当前目录查找文件了.

C语言的内核很小, 只包括了一些非常基础的功能, 而其他的部分则都通过库来提供.
同时又因为它相对比较简陋, 所以当我们使用它的库的时候需要一个描述文件,
这个文件就可以告诉编译器, 这个库提供了哪些功能.
比如我们下面会说到的 `printf` 就是由stdio.h文件告知编译器的.

下面就是我们程序的主体了.
